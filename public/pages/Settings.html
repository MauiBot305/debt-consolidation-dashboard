<!-- Settings - System Configuration -->
<div class="space-y-6">
  <!-- Page Header -->
  <div class="flex items-center justify-between mb-8 fade-in-up stagger-1">
    <div>
      <h1 class="text-3xl font-bold text-white mb-2 font-orbitron">System Settings</h1>
      <p class="text-gray-400">Configure your account and system preferences</p>
    </div>
    <div class="flex gap-3">
      <button onclick="resetSettings()" class="btn text-white px-4 py-2 rounded-lg bg-gray-700 hover:bg-gray-600">
        <i data-lucide="rotate-ccw" class="w-4 h-4 inline mr-2"></i>
        Reset to Default
      </button>
      <button onclick="saveSettings()" class="btn btn-primary flex items-center gap-2">
        <i data-lucide="save" class="w-4 h-4"></i>
        Save Changes
      </button>
    </div>
  </div>

  <!-- Settings Navigation Tabs -->
  <div class="glass-card rounded-2xl p-2 fade-in-up stagger-2">
    <div class="flex gap-2 overflow-x-auto">
      <button onclick="switchTab('profile')" class="settings-tab active" data-tab="profile">
        <i data-lucide="user" class="w-4 h-4"></i>
        Profile
      </button>
      <button onclick="switchTab('company')" class="settings-tab" data-tab="company">
        <i data-lucide="building-2" class="w-4 h-4"></i>
        Company
      </button>
      <button onclick="switchTab('notifications')" class="settings-tab" data-tab="notifications">
        <i data-lucide="bell" class="w-4 h-4"></i>
        Notifications
      </button>
      <button onclick="switchTab('integrations')" class="settings-tab" data-tab="integrations">
        <i data-lucide="plug" class="w-4 h-4"></i>
        Integrations
      </button>
      <button onclick="switchTab('permissions')" class="settings-tab" data-tab="permissions">
        <i data-lucide="shield" class="w-4 h-4"></i>
        Permissions
      </button>
      <button onclick="switchTab('pipeline')" class="settings-tab" data-tab="pipeline">
        <i data-lucide="git-branch" class="w-4 h-4"></i>
        Pipeline
      </button>
      <button onclick="switchTab('templates')" class="settings-tab" data-tab="templates">
        <i data-lucide="file-text" class="w-4 h-4"></i>
        Templates
      </button>
      <button onclick="switchTab('fees')" class="settings-tab" data-tab="fees">
        <i data-lucide="dollar-sign" class="w-4 h-4"></i>
        Fees
      </button>
      <button onclick="switchTab('data')" class="settings-tab" data-tab="data">
        <i data-lucide="database" class="w-4 h-4"></i>
        Data
      </button>
      <button onclick="switchTab('audit')" class="settings-tab" data-tab="audit">
        <i data-lucide="file-search" class="w-4 h-4"></i>
        Audit Log
      </button>
    </div>
  </div>

  <!-- Settings Content -->
  <div id="settingsContent" class="fade-in-up stagger-3">
    <!-- Content panels will be rendered here -->
  </div>
</div>

<style>
.settings-tab {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 20px;
  background: transparent;
  color: #94a3b8;
  border-radius: 10px;
  border: none;
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;
  font-size: 14px;
  font-weight: 500;
}

.settings-tab:hover {
  background: rgba(59, 130, 246, 0.1);
  color: #fff;
}

.settings-tab.active {
  background: linear-gradient(90deg, rgba(59, 130, 246, 0.2), rgba(6, 182, 212, 0.1));
  color: #fff;
  box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
}

.settings-section {
  background: rgba(15, 23, 42, 0.8);
  backdrop-filter: blur(20px);
  border: 1px solid rgba(59, 130, 246, 0.1);
  border-radius: 16px;
  padding: 24px;
  margin-bottom: 24px;
}

.settings-section h3 {
  font-size: 18px;
  font-weight: 700;
  color: white;
  margin-bottom: 16px;
  display: flex;
  align-items: center;
  gap: 12px;
}

.form-group {
  margin-bottom: 20px;
}

.form-group label {
  display: block;
  font-size: 14px;
  font-weight: 500;
  color: #e2e8f0;
  margin-bottom: 8px;
}

.form-group input[type="text"],
.form-group input[type="email"],
.form-group input[type="password"],
.form-group input[type="number"],
.form-group textarea,
.form-group select {
  width: 100%;
  padding: 12px 16px;
  background: #0a0f1a;
  border: 1px solid #334155;
  border-radius: 10px;
  color: white;
  font-size: 14px;
  transition: all 0.2s;
}

.form-group input:focus,
.form-group textarea:focus,
.form-group select:focus {
  outline: none;
  border-color: #3B82F6;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.toggle-switch {
  position: relative;
  width: 48px;
  height: 24px;
  background: #334155;
  border-radius: 12px;
  cursor: pointer;
  transition: background 0.2s;
}

.toggle-switch.active {
  background: linear-gradient(90deg, #3B82F6, #06B6D4);
}

.toggle-switch::after {
  content: '';
  position: absolute;
  width: 20px;
  height: 20px;
  background: white;
  border-radius: 50%;
  top: 2px;
  left: 2px;
  transition: transform 0.2s;
}

.toggle-switch.active::after {
  transform: translateX(24px);
}
</style>

<script>
// Current settings state
let currentSettings = {};

function initSettings() {
  // Load settings from localStorage
  const saved = localStorage.getItem('debt_empire_settings');
  currentSettings = saved ? JSON.parse(saved) : getDefaultSettings();
  
  // Render initial tab
  switchTab('profile');
}

function getDefaultSettings() {
  return {
    profile: {
      name: Auth.getSession().name,
      email: Auth.getSession().email,
      phone: '(555) 123-4567',
      avatar: Auth.getSession().avatar
    },
    company: {
      name: 'Debt Consolidation Empire',
      website: 'www.debtempire.com',
      phone: '(800) 555-0100',
      address: '123 Business St, Suite 400',
      city: 'New York',
      state: 'NY',
      zip: '10001'
    },
    notifications: {
      emailNewLead: true,
      emailEnrollment: true,
      emailPayment: true,
      smsTaskDue: true,
      smsAppointment: true,
      pushCallReminder: true,
      pushTeamUpdate: false
    },
    integrations: {
      twilio: { sid: 'ACxxxxxxxxxx', token: '••••••••', number: '+18005550100' },
      stripe: { key: 'sk_test_xxxxxxxxxx', webhook: '••••••••' },
      docusign: { apiKey: '••••••••', accountId: 'xxxxxxxxx' }
    },
    fees: {
      enrollmentFee: 49,
      programFeePercent: 15,
      monthlyServiceFee: 25,
      settlementFeePercent: 25
    },
    theme: 'dark'
  };
}

function switchTab(tabName) {
  // Update tab buttons
  document.querySelectorAll('.settings-tab').forEach(tab => {
    tab.classList.remove('active');
  });
  document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
  
  // Render tab content
  const content = document.getElementById('settingsContent');
  
  switch(tabName) {
    case 'profile':
      content.innerHTML = renderProfileSettings();
      break;
    case 'company':
      content.innerHTML = renderCompanySettings();
      break;
    case 'notifications':
      content.innerHTML = renderNotificationSettings();
      break;
    case 'integrations':
      content.innerHTML = renderIntegrationSettings();
      break;
    case 'permissions':
      content.innerHTML = renderPermissionsSettings();
      break;
    case 'pipeline':
      content.innerHTML = renderPipelineSettings();
      break;
    case 'templates':
      content.innerHTML = renderTemplateSettings();
      break;
    case 'fees':
      content.innerHTML = renderFeeSettings();
      break;
    case 'data':
      content.innerHTML = renderDataSettings();
      break;
    case 'audit':
      content.innerHTML = renderAuditLog();
      break;
  }
  
  lucide.createIcons();
}

function renderProfileSettings() {
  const profile = currentSettings.profile || getDefaultSettings().profile;
  
  return `
    <div class="settings-section">
      <h3>
        <i data-lucide="user" class="w-5 h-5 text-blue-400"></i>
        Personal Information
      </h3>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="form-group">
          <label>Full Name</label>
          <input type="text" value="${profile.name}" id="profileName" placeholder="John Smith">
        </div>
        
        <div class="form-group">
          <label>Email Address</label>
          <input type="email" value="${profile.email}" id="profileEmail" placeholder="john@debtempire.com">
        </div>
        
        <div class="form-group">
          <label>Phone Number</label>
          <input type="text" value="${profile.phone}" id="profilePhone" placeholder="(555) 123-4567">
        </div>
        
        <div class="form-group">
          <label>Avatar URL</label>
          <input type="text" value="${profile.avatar}" id="profileAvatar" placeholder="https://...">
        </div>
      </div>
    </div>
    
    <div class="settings-section">
      <h3>
        <i data-lucide="lock" class="w-5 h-5 text-yellow-400"></i>
        Change Password
      </h3>
      
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="form-group">
          <label>Current Password</label>
          <input type="password" placeholder="••••••••">
        </div>
        
        <div class="form-group">
          <label>New Password</label>
          <input type="password" placeholder="••••••••">
        </div>
        
        <div class="form-group">
          <label>Confirm Password</label>
          <input type="password" placeholder="••••••••">
        </div>
      </div>
    </div>
    
    <div class="settings-section">
      <h3>
        <i data-lucide="palette" class="w-5 h-5 text-purple-400"></i>
        Theme Preference
      </h3>
      
      <div class="flex gap-4">
        <button class="p-4 bg-[#0a0f1a] border-2 border-blue-500 rounded-lg flex-1 text-white">
          <i data-lucide="moon" class="w-6 h-6 mx-auto mb-2"></i>
          Dark Mode
        </button>
        <button class="p-4 bg-[#0a0f1a] border border-gray-800 rounded-lg flex-1 text-gray-400 opacity-50">
          <i data-lucide="sun" class="w-6 h-6 mx-auto mb-2"></i>
          Light Mode (Coming Soon)
        </button>
      </div>
    </div>
  `;
}

function renderCompanySettings() {
  const company = currentSettings.company || getDefaultSettings().company;
  
  return `
    <div class="settings-section">
      <h3>
        <i data-lucide="building-2" class="w-5 h-5 text-cyan-400"></i>
        Company Information
      </h3>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="form-group">
          <label>Company Name</label>
          <input type="text" value="${company.name}" id="companyName">
        </div>
        
        <div class="form-group">
          <label>Website</label>
          <input type="text" value="${company.website}" id="companyWebsite">
        </div>
        
        <div class="form-group">
          <label>Phone Number</label>
          <input type="text" value="${company.phone}" id="companyPhone">
        </div>
        
        <div class="form-group">
          <label>Support Email</label>
          <input type="email" placeholder="support@debtempire.com">
        </div>
        
        <div class="form-group md:col-span-2">
          <label>Address</label>
          <input type="text" value="${company.address}" id="companyAddress">
        </div>
        
        <div class="form-group">
          <label>City</label>
          <input type="text" value="${company.city}" id="companyCity">
        </div>
        
        <div class="form-group">
          <label>State</label>
          <input type="text" value="${company.state}" id="companyState">
        </div>
        
        <div class="form-group">
          <label>ZIP Code</label>
          <input type="text" value="${company.zip}" id="companyZip">
        </div>
      </div>
    </div>
  `;
}

function renderNotificationSettings() {
  const notif = currentSettings.notifications || getDefaultSettings().notifications;
  
  return `
    <div class="settings-section">
      <h3>
        <i data-lucide="mail" class="w-5 h-5 text-blue-400"></i>
        Email Notifications
      </h3>
      
      <div class="space-y-4">
        ${renderToggle('New Lead Assigned', 'emailNewLead', notif.emailNewLead)}
        ${renderToggle('Client Enrollment', 'emailEnrollment', notif.emailEnrollment)}
        ${renderToggle('Payment Received', 'emailPayment', notif.emailPayment)}
      </div>
    </div>
    
    <div class="settings-section">
      <h3>
        <i data-lucide="message-circle" class="w-5 h-5 text-green-400"></i>
        SMS Notifications
      </h3>
      
      <div class="space-y-4">
        ${renderToggle('Task Due Soon', 'smsTaskDue', notif.smsTaskDue)}
        ${renderToggle('Appointment Reminder', 'smsAppointment', notif.smsAppointment)}
      </div>
    </div>
    
    <div class="settings-section">
      <h3>
        <i data-lucide="bell" class="w-5 h-5 text-yellow-400"></i>
        Push Notifications
      </h3>
      
      <div class="space-y-4">
        ${renderToggle('Call Reminder', 'pushCallReminder', notif.pushCallReminder)}
        ${renderToggle('Team Updates', 'pushTeamUpdate', notif.pushTeamUpdate)}
      </div>
    </div>
  `;
}

function renderToggle(label, id, active) {
  return `
    <div class="flex items-center justify-between p-4 bg-[#0a0f1a] rounded-lg border border-gray-800">
      <span class="text-white">${label}</span>
      <div class="toggle-switch ${active ? 'active' : ''}" onclick="toggleSetting('${id}')" data-toggle="${id}"></div>
    </div>
  `;
}

function renderIntegrationSettings() {
  return `
    <div class="settings-section">
      <h3>
        <i data-lucide="phone" class="w-5 h-5 text-green-400"></i>
        Twilio (Voice & SMS)
      </h3>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="form-group">
          <label>Account SID</label>
          <input type="text" placeholder="ACxxxxxxxxxxxxxxxxxxxxxxxxxx">
        </div>
        
        <div class="form-group">
          <label>Auth Token</label>
          <input type="password" placeholder="••••••••••••••••">
        </div>
        
        <div class="form-group">
          <label>Phone Number</label>
          <input type="text" placeholder="+1 (800) 555-0100">
        </div>
        
        <div class="form-group flex items-end">
          <button class="btn btn-primary w-full">Test Connection</button>
        </div>
      </div>
    </div>
    
    <div class="settings-section">
      <h3>
        <i data-lucide="credit-card" class="w-5 h-5 text-blue-400"></i>
        Stripe (Payments)
      </h3>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="form-group">
          <label>Publishable Key</label>
          <input type="text" placeholder="pk_test_xxxxxxxxxxxx">
        </div>
        
        <div class="form-group">
          <label>Secret Key</label>
          <input type="password" placeholder="sk_test_xxxxxxxxxxxx">
        </div>
        
        <div class="form-group md:col-span-2">
          <label>Webhook Endpoint</label>
          <input type="text" placeholder="https://yourapp.com/webhooks/stripe">
        </div>
        
        <div class="form-group flex items-end">
          <button class="btn btn-primary w-full">Test Connection</button>
        </div>
      </div>
    </div>
    
    <div class="settings-section">
      <h3>
        <i data-lucide="file-signature" class="w-5 h-5 text-yellow-400"></i>
        DocuSign (e-Signatures)
      </h3>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="form-group">
          <label>Integration Key</label>
          <input type="text" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx">
        </div>
        
        <div class="form-group">
          <label>Account ID</label>
          <input type="text" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx">
        </div>
        
        <div class="form-group flex items-end">
          <button class="btn btn-primary w-full">Test Connection</button>
        </div>
      </div>
    </div>
  `;
}

function renderPermissionsSettings() {
  return `
    <div class="settings-section">
      <h3>
        <i data-lucide="shield" class="w-5 h-5 text-purple-400"></i>
        Role & Permissions Matrix
      </h3>
      
      <div class="overflow-x-auto">
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-800">
              <th class="text-left p-3 text-gray-400">Permission</th>
              <th class="text-center p-3 text-blue-400">Agent</th>
              <th class="text-center p-3 text-cyan-400">Manager</th>
              <th class="text-center p-3 text-green-400">Owner</th>
            </tr>
          </thead>
          <tbody class="text-white">
            ${renderPermissionRow('View Leads', true, true, true)}
            ${renderPermissionRow('Call Leads', true, true, true)}
            ${renderPermissionRow('Update Leads', true, true, true)}
            ${renderPermissionRow('Delete Leads', false, true, true)}
            ${renderPermissionRow('View Team Stats', false, true, true)}
            ${renderPermissionRow('Assign Leads', false, true, true)}
            ${renderPermissionRow('Manage Team', false, true, true)}
            ${renderPermissionRow('View Reports', false, true, true)}
            ${renderPermissionRow('System Settings', false, false, true)}
            ${renderPermissionRow('Billing & Finance', false, false, true)}
          </tbody>
        </table>
      </div>
    </div>
  `;
}

function renderPermissionRow(permission, agent, manager, owner) {
  const checkmark = '<i data-lucide="check" class="w-5 h-5 text-green-400 mx-auto"></i>';
  const cross = '<i data-lucide="x" class="w-5 h-5 text-gray-600 mx-auto"></i>';
  
  return `
    <tr class="border-b border-gray-800/50 hover:bg-blue-500/5">
      <td class="p-3">${permission}</td>
      <td class="text-center p-3">${agent ? checkmark : cross}</td>
      <td class="text-center p-3">${manager ? checkmark : cross}</td>
      <td class="text-center p-3">${owner ? checkmark : cross}</td>
    </tr>
  `;
}

function renderPipelineSettings() {
  return `
    <div class="settings-section">
      <h3>
        <i data-lucide="git-branch" class="w-5 h-5 text-cyan-400"></i>
        Pipeline Stage Customization
      </h3>
      
      <p class="text-gray-400 text-sm mb-4">Drag to reorder, click to edit, or add new stages.</p>
      
      <div class="space-y-3" id="pipelineStages">
        ${DB.pipelineStages.map((stage, i) => `
          <div class="flex items-center gap-3 p-4 bg-[#0a0f1a] border border-gray-800 rounded-lg hover:border-blue-500/30 cursor-move">
            <i data-lucide="grip-vertical" class="w-5 h-5 text-gray-600"></i>
            <div class="flex-1">
              <input type="text" value="${stage}" class="bg-transparent border-none outline-none text-white w-full">
            </div>
            <button class="p-2 hover:bg-red-500/20 rounded-lg text-red-400">
              <i data-lucide="trash-2" class="w-4 h-4"></i>
            </button>
          </div>
        `).join('')}
      </div>
      
      <button class="btn btn-primary mt-4">
        <i data-lucide="plus" class="w-4 h-4 inline mr-2"></i>
        Add New Stage
      </button>
    </div>
  `;
}

function renderTemplateSettings() {
  return `
    <div class="settings-section">
      <h3>
        <i data-lucide="mail" class="w-5 h-5 text-blue-400"></i>
        Email Templates
      </h3>
      
      <div class="space-y-4">
        ${renderTemplateItem('Welcome Email', 'Sent when client enrolls')}
        ${renderTemplateItem('Payment Reminder', 'Sent 3 days before due')}
        ${renderTemplateItem('Document Request', 'Request missing paperwork')}
      </div>
      
      <button class="btn btn-primary mt-4">
        <i data-lucide="plus" class="w-4 h-4 inline mr-2"></i>
        Create Template
      </button>
    </div>
    
    <div class="settings-section">
      <h3>
        <i data-lucide="message-circle" class="w-5 h-5 text-green-400"></i>
        SMS Templates
      </h3>
      
      <div class="space-y-4">
        ${renderTemplateItem('Appointment Reminder', 'Sent 1 hour before call')}
        ${renderTemplateItem('Payment Confirmation', 'Sent after payment received')}
      </div>
      
      <button class="btn btn-primary mt-4">
        <i data-lucide="plus" class="w-4 h-4 inline mr-2"></i>
        Create Template
      </button>
    </div>
  `;
}

function renderTemplateItem(name, desc) {
  return `
    <div class="flex items-center justify-between p-4 bg-[#0a0f1a] border border-gray-800 rounded-lg hover:border-blue-500/30">
      <div>
        <p class="text-white font-semibold">${name}</p>
        <p class="text-sm text-gray-400">${desc}</p>
      </div>
      <button class="btn text-white px-3 py-2 bg-blue-500 hover:bg-blue-600 rounded-lg">
        <i data-lucide="edit" class="w-4 h-4 inline mr-2"></i>
        Edit
      </button>
    </div>
  `;
}

function renderFeeSettings() {
  const fees = currentSettings.fees || getDefaultSettings().fees;
  
  return `
    <div class="settings-section">
      <h3>
        <i data-lucide="dollar-sign" class="w-5 h-5 text-green-400"></i>
        Fee Structure Configuration
      </h3>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="form-group">
          <label>Enrollment Fee</label>
          <div class="flex items-center gap-2">
            <span class="text-gray-400">$</span>
            <input type="number" value="${fees.enrollmentFee}" id="enrollmentFee" class="flex-1">
          </div>
        </div>
        
        <div class="form-group">
          <label>Program Fee (%)</label>
          <div class="flex items-center gap-2">
            <input type="number" value="${fees.programFeePercent}" id="programFeePercent" class="flex-1">
            <span class="text-gray-400">%</span>
          </div>
        </div>
        
        <div class="form-group">
          <label>Monthly Service Fee</label>
          <div class="flex items-center gap-2">
            <span class="text-gray-400">$</span>
            <input type="number" value="${fees.monthlyServiceFee}" id="monthlyServiceFee" class="flex-1">
          </div>
        </div>
        
        <div class="form-group">
          <label>Settlement Fee (%)</label>
          <div class="flex items-center gap-2">
            <input type="number" value="${fees.settlementFeePercent}" id="settlementFeePercent" class="flex-1">
            <span class="text-gray-400">%</span>
          </div>
        </div>
      </div>
      
      <div class="mt-6 p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg">
        <p class="text-sm text-blue-400 mb-2"><strong>Example Calculation:</strong></p>
        <p class="text-sm text-gray-300">Client with $50,000 debt:</p>
        <ul class="text-sm text-gray-400 space-y-1 ml-4 mt-2">
          <li>• Enrollment Fee: $${fees.enrollmentFee}</li>
          <li>• Program Fee (${fees.programFeePercent}%): $${(50000 * fees.programFeePercent / 100).toLocaleString()}</li>
          <li>• Monthly Service: $${fees.monthlyServiceFee}/month</li>
        </ul>
      </div>
    </div>
  `;
}

function renderDataSettings() {
  return `
    <div class="settings-section">
      <h3>
        <i data-lucide="download" class="w-5 h-5 text-blue-400"></i>
        Export Data
      </h3>
      
      <p class="text-gray-400 text-sm mb-4">Download your data for backup or migration purposes.</p>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <button class="btn btn-primary">
          <i data-lucide="users" class="w-4 h-4 inline mr-2"></i>
          Export Leads (CSV)
        </button>
        <button class="btn btn-primary">
          <i data-lucide="briefcase" class="w-4 h-4 inline mr-2"></i>
          Export Cases (CSV)
        </button>
        <button class="btn btn-primary">
          <i data-lucide="activity" class="w-4 h-4 inline mr-2"></i>
          Export Activities (CSV)
        </button>
        <button class="btn btn-primary">
          <i data-lucide="database" class="w-4 h-4 inline mr-2"></i>
          Full Database Export (JSON)
        </button>
      </div>
    </div>
    
    <div class="settings-section">
      <h3>
        <i data-lucide="upload" class="w-5 h-5 text-green-400"></i>
        Import Data
      </h3>
      
      <p class="text-gray-400 text-sm mb-4">Upload CSV or JSON files to import data.</p>
      
      <div class="p-8 border-2 border-dashed border-gray-700 rounded-lg text-center hover:border-blue-500 transition-colors cursor-pointer">
        <i data-lucide="upload-cloud" class="w-12 h-12 text-gray-500 mx-auto mb-3"></i>
        <p class="text-white mb-2">Drag & drop files here</p>
        <p class="text-sm text-gray-400">or click to browse</p>
        <input type="file" class="hidden" accept=".csv,.json">
      </div>
    </div>
    
    <div class="settings-section border-red-500/30">
      <h3>
        <i data-lucide="trash-2" class="w-5 h-5 text-red-400"></i>
        Danger Zone
      </h3>
      
      <p class="text-gray-400 text-sm mb-4">Irreversible actions. Proceed with caution.</p>
      
      <button class="btn text-white px-4 py-2 rounded-lg bg-red-600 hover:bg-red-700">
        <i data-lucide="rotate-ccw" class="w-4 h-4 inline mr-2"></i>
        Reset All Data
      </button>
    </div>
  `;
}

function renderAuditLog() {
  const logs = [
    { user: 'John Smith', action: 'Updated lead L003 status', timestamp: '2026-02-24T10:30:00', type: 'update' },
    { user: 'Sarah Johnson', action: 'Exported leads report', timestamp: '2026-02-24T09:15:00', type: 'export' },
    { user: 'Patrick Chinery', action: 'Modified fee structure', timestamp: '2026-02-24T08:45:00', type: 'config' },
    { user: 'John Smith', action: 'Created new lead L050', timestamp: '2026-02-24T08:15:00', type: 'create' }
  ];
  
  const typeColors = {
    update: 'text-blue-400 bg-blue-500/10',
    export: 'text-green-400 bg-green-500/10',
    config: 'text-yellow-400 bg-yellow-500/10',
    create: 'text-cyan-400 bg-cyan-500/10',
    delete: 'text-red-400 bg-red-500/10'
  };
  
  return `
    <div class="settings-section">
      <h3>
        <i data-lucide="file-search" class="w-5 h-5 text-purple-400"></i>
        System Audit Log
      </h3>
      
      <div class="space-y-3">
        ${logs.map(log => `
          <div class="flex items-center gap-4 p-4 bg-[#0a0f1a] border border-gray-800 rounded-lg">
            <div class="p-2 rounded-lg ${typeColors[log.type]}">
              <i data-lucide="${log.type === 'update' ? 'edit' : log.type === 'export' ? 'download' : log.type === 'config' ? 'settings' : 'plus'}" class="w-4 h-4"></i>
            </div>
            <div class="flex-1">
              <p class="text-white">${log.action}</p>
              <p class="text-sm text-gray-400">${log.user} • ${DBHelpers.formatDate(log.timestamp)}</p>
            </div>
          </div>
        `).join('')}
      </div>
      
      <button class="btn btn-primary mt-4 w-full">
        Load More
      </button>
    </div>
  `;
}

function toggleSetting(id) {
  const toggle = document.querySelector(`[data-toggle="${id}"]`);
  toggle.classList.toggle('active');
}

function saveSettings() {
  Toast.success('Settings saved successfully!');
  localStorage.setItem('debt_empire_settings', JSON.stringify(currentSettings));
}

function resetSettings() {
  if (confirm('Are you sure you want to reset all settings to default?')) {
    currentSettings = getDefaultSettings();
    localStorage.setItem('debt_empire_settings', JSON.stringify(currentSettings));
    switchTab('profile');
    Toast.info('Settings reset to default');
  }
}
</script>
