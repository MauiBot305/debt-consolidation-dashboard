<!-- Functionality verified by Agent 3 -->
<!-- Client Portal - Client-Facing Interface Preview -->
<div class="space-y-6">
  <!-- Page Header -->
  <div class="flex items-center justify-between mb-8 fade-in-up stagger-1">
    <div>
      <h1 class="text-3xl font-bold text-white mb-2 font-orbitron">Client Portal Preview</h1>
      <p class="text-gray-400">Demo of the client-facing experience</p>
    </div>
    <div class="flex gap-3">
      <button onclick="toggleClientView()" class="btn btn-primary flex items-center gap-2">
        <i data-lucide="eye" class="w-4 h-4"></i>
        <span id="viewToggleText">Switch to Client View</span>
      </button>
    </div>
  </div>

  <!-- Admin View / Client Login Simulation -->
  <div id="adminView" class="fade-in-up stagger-2">
    <div class="glass-card rounded-2xl p-6">
      <div class="flex items-center gap-3 mb-6">
        <div class="p-2 bg-blue-500/20 rounded-lg">
          <i data-lucide="user-circle" class="w-5 h-5 text-blue-400"></i>
        </div>
        <div>
          <h2 class="text-xl font-bold text-white">Client Login Simulation</h2>
          <p class="text-sm text-gray-400">Select a client to preview their portal experience</p>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        ${renderClientCards()}
      </div>
    </div>
  </div>

  <!-- Client View -->
  <div id="clientView" class="hidden">
    <!-- Client Portal Header -->
    <div class="glass-card rounded-2xl p-6 mb-6 fade-in-up stagger-2">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-4">
          <div class="avatar-ring">
            <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-full flex items-center justify-center text-white text-2xl font-bold">
              EP
            </div>
          </div>
          <div>
            <h2 class="text-2xl font-bold text-white" id="clientName">Emily Parker</h2>
            <p class="text-gray-400">Account #CASE001</p>
            <div class="flex items-center gap-2 mt-1">
              <span class="px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full border border-green-500/30">In Program</span>
              <span class="status-dot bg-green-400"></span>
              <span class="text-xs text-gray-400">Active</span>
            </div>
          </div>
        </div>
        <button onclick="toggleClientView()" class="text-sm text-gray-400 hover:text-white flex items-center gap-2">
          <i data-lucide="log-out" class="w-4 h-4"></i>
          Sign Out
        </button>
      </div>
    </div>

    <!-- Client Dashboard Content -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Left Column: Main Content -->
      <div class="lg:col-span-2 space-y-6">
        <!-- Case Status Overview -->
        <div class="glass-card rounded-2xl p-6 fade-in-up stagger-3">
          <div class="flex items-center gap-3 mb-6">
            <div class="p-2 bg-cyan-500/20 rounded-lg">
              <i data-lucide="briefcase" class="w-5 h-5 text-cyan-400"></i>
            </div>
            <div>
              <h2 class="text-xl font-bold text-white">Case Status</h2>
              <p class="text-sm text-gray-400">Your debt relief progress</p>
            </div>
          </div>

          <!-- Progress Visualization -->
          <div class="mb-6">
            <div class="flex justify-between text-sm mb-3">
              <span class="text-gray-400">Overall Progress</span>
              <span class="text-white font-semibold">32% Complete</span>
            </div>
            <div class="progress-bar h-4">
              <div class="progress-fill h-full" style="width: 32%; background: linear-gradient(90deg, #22C55E, #10B981);">
                <div class="w-full h-full flex items-center justify-end pr-2">
                  <div class="w-3 h-3 bg-white rounded-full shadow-lg"></div>
                </div>
              </div>
            </div>
            <div class="flex justify-between text-xs text-gray-500 mt-2">
              <span>Enrolled</span>
              <span>Settlement</span>
              <span>Completed</span>
            </div>
          </div>

          <!-- Key Metrics -->
          <div class="grid grid-cols-3 gap-4">
            <div class="text-center p-4 bg-[#0a0f1a] rounded-lg border border-gray-800">
              <div class="font-orbitron text-2xl font-bold text-white mb-1">$52,000</div>
              <div class="text-xs text-gray-400">Total Debt</div>
            </div>
            <div class="text-center p-4 bg-[#0a0f1a] rounded-lg border border-gray-800">
              <div class="font-orbitron text-2xl font-bold text-yellow-400 mb-1">$3,250</div>
              <div class="text-xs text-gray-400">Account Balance</div>
            </div>
            <div class="text-center p-4 bg-[#0a0f1a] rounded-lg border border-gray-800">
              <div class="font-orbitron text-2xl font-bold text-cyan-400 mb-1">18 mos</div>
              <div class="text-xs text-gray-400">Est. Completion</div>
            </div>
          </div>

          <!-- Creditor Breakdown -->
          <div class="mt-6">
            <h3 class="text-sm font-semibold text-white mb-3">Creditor Breakdown</h3>
            <div class="space-y-3">
              <div class="p-3 bg-[#0a0f1a] rounded-lg border border-gray-800">
                <div class="flex items-center justify-between mb-2">
                  <span class="text-white font-semibold">Capital One</span>
                  <span class="px-2 py-1 bg-yellow-500/20 text-yellow-400 text-xs rounded-full">In Program</span>
                </div>
                <div class="text-sm text-gray-400 mb-2">Balance: <span class="font-orbitron text-white">$18,000</span></div>
                <div class="progress-bar h-2">
                  <div class="progress-fill" style="width: 25%;"></div>
                </div>
              </div>

              <div class="p-3 bg-[#0a0f1a] rounded-lg border border-gray-800">
                <div class="flex items-center justify-between mb-2">
                  <span class="text-white font-semibold">Synchrony Bank</span>
                  <span class="px-2 py-1 bg-yellow-500/20 text-yellow-400 text-xs rounded-full">In Program</span>
                </div>
                <div class="text-sm text-gray-400 mb-2">Balance: <span class="font-orbitron text-white">$22,000</span></div>
                <div class="progress-bar h-2">
                  <div class="progress-fill" style="width: 30%;"></div>
                </div>
              </div>

              <div class="p-3 bg-[#0a0f1a] rounded-lg border border-gray-800">
                <div class="flex items-center justify-between mb-2">
                  <span class="text-white font-semibold">Medical Collections</span>
                  <span class="px-2 py-1 bg-yellow-500/20 text-yellow-400 text-xs rounded-full">In Program</span>
                </div>
                <div class="text-sm text-gray-400 mb-2">Balance: <span class="font-orbitron text-white">$12,000</span></div>
                <div class="progress-bar h-2">
                  <div class="progress-fill" style="width: 15%;"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Payment History -->
        <div class="glass-card rounded-2xl p-6 fade-in-up stagger-4">
          <div class="flex items-center justify-between mb-6">
            <div class="flex items-center gap-3">
              <div class="p-2 bg-green-500/20 rounded-lg">
                <i data-lucide="credit-card" class="w-5 h-5 text-green-400"></i>
              </div>
              <div>
                <h2 class="text-xl font-bold text-white">Payment History</h2>
                <p class="text-sm text-gray-400">Your recent payments</p>
              </div>
            </div>
            <button class="text-sm text-blue-400 hover:text-blue-300 flex items-center gap-2">
              View All <i data-lucide="arrow-right" class="w-4 h-4"></i>
            </button>
          </div>

          <!-- Next Payment Due -->
          <div class="p-4 mb-6 rounded-lg" style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(6, 182, 212, 0.1)); border: 1px solid rgba(59, 130, 246, 0.3);">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-gray-400 mb-1">Next Payment Due</p>
                <p class="text-2xl font-orbitron font-bold text-white">$650.00</p>
                <p class="text-sm text-cyan-400 mt-1">Due on March 1, 2026</p>
              </div>
              <button class="btn btn-primary">
                <i data-lucide="credit-card" class="w-4 h-4 inline mr-2"></i>
                Pay Now
              </button>
            </div>
          </div>

          <!-- Payment Table -->
          <div class="overflow-x-auto">
            <table class="w-full text-sm">
              <thead>
                <tr class="border-b border-gray-800">
                  <th class="text-left p-3 text-gray-400">Date</th>
                  <th class="text-left p-3 text-gray-400">Amount</th>
                  <th class="text-left p-3 text-gray-400">Method</th>
                  <th class="text-center p-3 text-gray-400">Status</th>
                </tr>
              </thead>
              <tbody class="text-white">
                <tr class="border-b border-gray-800/50 hover:bg-blue-500/5">
                  <td class="p-3">Feb 1, 2026</td>
                  <td class="p-3 font-orbitron">$650.00</td>
                  <td class="p-3">ACH •••• 4532</td>
                  <td class="text-center p-3">
                    <span class="px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full">Completed</span>
                  </td>
                </tr>
                <tr class="border-b border-gray-800/50 hover:bg-blue-500/5">
                  <td class="p-3">Jan 1, 2026</td>
                  <td class="p-3 font-orbitron">$650.00</td>
                  <td class="p-3">ACH •••• 4532</td>
                  <td class="text-center p-3">
                    <span class="px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full">Completed</span>
                  </td>
                </tr>
                <tr class="border-b border-gray-800/50 hover:bg-blue-500/5">
                  <td class="p-3">Dec 1, 2025</td>
                  <td class="p-3 font-orbitron">$650.00</td>
                  <td class="p-3">ACH •••• 4532</td>
                  <td class="text-center p-3">
                    <span class="px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full">Completed</span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Document Center -->
        <div class="glass-card rounded-2xl p-6 fade-in-up stagger-5">
          <div class="flex items-center gap-3 mb-6">
            <div class="p-2 bg-yellow-500/20 rounded-lg">
              <i data-lucide="folder" class="w-5 h-5 text-yellow-400"></i>
            </div>
            <div>
              <h2 class="text-xl font-bold text-white">Document Center</h2>
              <p class="text-sm text-gray-400">View and manage your documents</p>
            </div>
          </div>

          <!-- Upload Area -->
          <div class="mb-6 p-6 border-2 border-dashed border-gray-700 rounded-lg text-center hover:border-blue-500 transition-colors cursor-pointer">
            <i data-lucide="upload" class="w-10 h-10 text-gray-500 mx-auto mb-2"></i>
            <p class="text-white mb-1">Upload a Document</p>
            <p class="text-sm text-gray-400">Click or drag files here</p>
          </div>

          <!-- Document List -->
          <div class="space-y-3">
            ${renderDocumentItem('Enrollment Agreement', 'PDF', '2.4 MB', 'Signed', 'check-circle', 'green')}
            ${renderDocumentItem('Bank Authorization', 'PDF', '1.8 MB', 'Signed', 'check-circle', 'green')}
            ${renderDocumentItem('Monthly Statement - Feb', 'PDF', '324 KB', 'View', 'file-text', 'blue')}
            ${renderDocumentItem('Tax Form 1099-C', 'PDF', '156 KB', 'Pending', 'clock', 'yellow')}
          </div>
        </div>
      </div>

      <!-- Right Column: Messaging & Support -->
      <div class="space-y-6">
        <!-- Secure Messaging -->
        <div class="glass-card rounded-2xl p-6 fade-in-up stagger-3">
          <div class="flex items-center gap-3 mb-6">
            <div class="p-2 bg-blue-500/20 rounded-lg">
              <i data-lucide="message-circle" class="w-5 h-5 text-blue-400"></i>
            </div>
            <div>
              <h2 class="text-xl font-bold text-white">Messages</h2>
              <div class="flex items-center gap-2">
                <span class="w-2 h-2 bg-red-500 rounded-full badge-pulse"></span>
                <span class="text-xs text-red-400">2 unread</span>
              </div>
            </div>
          </div>

          <!-- Message Thread -->
          <div class="space-y-3 mb-4 max-h-96 overflow-y-auto">
            <div class="flex gap-3">
              <div class="w-8 h-8 bg-blue-500 rounded-full flex-shrink-0 flex items-center justify-center text-white text-xs font-bold">
                JS
              </div>
              <div class="flex-1">
                <div class="bg-blue-500/10 p-3 rounded-lg border border-blue-500/20">
                  <p class="text-sm text-white mb-1">Hi Emily! Your next payment is scheduled for March 1st. Let me know if you need to adjust the date.</p>
                  <p class="text-xs text-gray-400">John Smith • 2 hours ago</p>
                </div>
              </div>
            </div>

            <div class="flex gap-3 flex-row-reverse">
              <div class="w-8 h-8 bg-cyan-500 rounded-full flex-shrink-0 flex items-center justify-center text-white text-xs font-bold">
                EP
              </div>
              <div class="flex-1">
                <div class="bg-cyan-500/10 p-3 rounded-lg border border-cyan-500/20 text-right">
                  <p class="text-sm text-white mb-1">Thanks! The date works perfectly.</p>
                  <p class="text-xs text-gray-400">You • 1 hour ago</p>
                </div>
              </div>
            </div>

            <div class="flex gap-3">
              <div class="w-8 h-8 bg-blue-500 rounded-full flex-shrink-0 flex items-center justify-center text-white text-xs font-bold">
                JS
              </div>
              <div class="flex-1">
                <div class="bg-blue-500/10 p-3 rounded-lg border border-blue-500/20">
                  <p class="text-sm text-white mb-1">Great! Also, we received your tax documents. Processing now.</p>
                  <p class="text-xs text-gray-400">John Smith • 30 min ago • <span class="text-red-400">Unread</span></p>
                </div>
              </div>
            </div>
          </div>

          <!-- Message Input -->
          <div class="flex gap-2">
            <input 
              type="text" 
              placeholder="Type your message..." 
              class="flex-1 px-4 py-2 bg-[#0a0f1a] border border-gray-800 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"
            >
            <button class="btn btn-primary p-2">
              <i data-lucide="send" class="w-5 h-5"></i>
            </button>
          </div>
        </div>

        <!-- Contact Info -->
        <div class="glass-card rounded-2xl p-6 fade-in-up stagger-4">
          <div class="flex items-center gap-3 mb-6">
            <div class="p-2 bg-green-500/20 rounded-lg">
              <i data-lucide="phone" class="w-5 h-5 text-green-400"></i>
            </div>
            <h2 class="text-xl font-bold text-white">Contact Us</h2>
          </div>

          <div class="space-y-4">
            <div class="flex items-start gap-3">
              <i data-lucide="user" class="w-5 h-5 text-blue-400 mt-0.5"></i>
              <div>
                <p class="text-sm text-gray-400">Your Agent</p>
                <p class="text-white font-semibold">John Smith</p>
              </div>
            </div>

            <div class="flex items-start gap-3">
              <i data-lucide="phone" class="w-5 h-5 text-green-400 mt-0.5"></i>
              <div>
                <p class="text-sm text-gray-400">Phone</p>
                <p class="text-white font-semibold">(800) 555-0100</p>
              </div>
            </div>

            <div class="flex items-start gap-3">
              <i data-lucide="mail" class="w-5 h-5 text-yellow-400 mt-0.5"></i>
              <div>
                <p class="text-sm text-gray-400">Email</p>
                <p class="text-white font-semibold">support@debtempire.com</p>
              </div>
            </div>

            <div class="flex items-start gap-3">
              <i data-lucide="clock" class="w-5 h-5 text-cyan-400 mt-0.5"></i>
              <div>
                <p class="text-sm text-gray-400">Hours</p>
                <p class="text-white font-semibold">Mon-Fri: 8am - 8pm EST</p>
              </div>
            </div>
          </div>

          <button class="btn btn-primary w-full mt-6">
            <i data-lucide="phone" class="w-4 h-4 inline mr-2"></i>
            Schedule a Call
          </button>
        </div>

        <!-- FAQ Section -->
        <div class="glass-card rounded-2xl p-6 fade-in-up stagger-5">
          <div class="flex items-center gap-3 mb-6">
            <div class="p-2 bg-purple-500/20 rounded-lg">
              <i data-lucide="help-circle" class="w-5 h-5 text-purple-400"></i>
            </div>
            <h2 class="text-xl font-bold text-white">FAQ</h2>
          </div>

          <div class="space-y-3">
            ${renderFAQItem('How do I change my payment date?', 'Contact your agent through the messaging system or call us directly.')}
            ${renderFAQItem('When will I see progress on my accounts?', 'Most clients see settlements within 12-24 months of enrollment.')}
            ${renderFAQItem('Can I make extra payments?', 'Yes! Extra payments help you complete the program faster.')}
            ${renderFAQItem('What if I miss a payment?', 'Contact us immediately. We can work with you on payment arrangements.')}
          </div>

          <button class="text-sm text-blue-400 hover:text-blue-300 flex items-center gap-2 mt-4">
            View All FAQs <i data-lucide="arrow-right" class="w-4 h-4"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
function initClientPortal() {
  // Initialize in admin view
  lucide.createIcons();
}

function renderClientCards() {
  const clients = [
    { name: 'Emily Parker', id: 'CASE001', debt: 52000, status: 'In Program' },
    { name: 'Robert Williams', id: 'CASE002', debt: 38000, status: 'Negotiating' },
    { name: 'Maria Rodriguez', id: 'CASE003', debt: 67000, status: 'In Program' }
  ];
  
  return clients.map(client => `
    <button onclick="selectClient('${client.id}')" class="glass-card rounded-xl p-4 text-left hover:scale-105 transition-transform">
      <div class="flex items-center gap-3 mb-3">
        <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-full flex items-center justify-center text-white font-bold">
          ${client.name.split(' ').map(n => n[0]).join('')}
        </div>
        <div>
          <p class="font-semibold text-white">${client.name}</p>
          <p class="text-xs text-gray-400">${client.id}</p>
        </div>
      </div>
      <div class="flex items-center justify-between text-sm">
        <span class="text-gray-400">Total Debt:</span>
        <span class="font-orbitron text-white">${DBHelpers.formatCurrency(client.debt)}</span>
      </div>
      <div class="mt-2">
        <span class="px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full">${client.status}</span>
      </div>
    </button>
  `).join('');
}

function selectClient(caseId) {
  toggleClientView();
}

function toggleClientView() {
  const adminView = document.getElementById('adminView');
  const clientView = document.getElementById('clientView');
  const toggleText = document.getElementById('viewToggleText');
  
  if (adminView.classList.contains('hidden')) {
    adminView.classList.remove('hidden');
    clientView.classList.add('hidden');
    toggleText.textContent = 'Switch to Client View';
  } else {
    adminView.classList.add('hidden');
    clientView.classList.remove('hidden');
    toggleText.textContent = 'Back to Admin View';
  }
  
  lucide.createIcons();
}

function renderDocumentItem(name, type, size, action, icon, color) {
  const colors = {
    green: 'text-green-400 bg-green-500/20',
    blue: 'text-blue-400 bg-blue-500/20',
    yellow: 'text-yellow-400 bg-yellow-500/20'
  };
  
  return `
    <div class="flex items-center justify-between p-3 bg-[#0a0f1a] border border-gray-800 rounded-lg hover:border-blue-500/30 transition-all">
      <div class="flex items-center gap-3">
        <div class="p-2 rounded-lg ${colors[color]}">
          <i data-lucide="${icon}" class="w-5 h-5"></i>
        </div>
        <div>
          <p class="text-sm font-semibold text-white">${name}</p>
          <p class="text-xs text-gray-400">${type} • ${size}</p>
        </div>
      </div>
      <button class="text-sm text-blue-400 hover:text-blue-300 flex items-center gap-2">
        ${action}
        <i data-lucide="download" class="w-4 h-4"></i>
      </button>
    </div>
  `;
}

function renderFAQItem(question, answer) {
  return `
    <details class="p-3 bg-[#0a0f1a] border border-gray-800 rounded-lg hover:border-purple-500/30 transition-all cursor-pointer">
      <summary class="text-sm font-semibold text-white flex items-center justify-between">
        ${question}
        <i data-lucide="chevron-down" class="w-4 h-4 text-gray-400"></i>
      </summary>
      <p class="text-sm text-gray-400 mt-2 pl-4">${answer}</p>
    </details>
  `;
}

// Auto-init on page load
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initClientPortal);
} else {
  initClientPortal();
}
</script>
